<!DOCTYPE html>
<html lang="en">
    <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
            <script src='https://kit.fontawesome.com/a076d05399.js'></script>
            <title>檢視會員</title>
            <script type="text/javascript" src="js/jquery-3.4.1.min.js"></script>
            <link rel="stylesheet" href="css/register.css">
            <style>
                
            </style>
        
</head>
<body class="ticket">
     
        <div class="background">
                <i class='fas fa-address-card'  style="font-size:55px; color:#0088A8;margin: 0% 0% 0% 5.3%;"></i>
                <h* style="font-size: 36px; color:#EE7700;">哭嚕嘰</h*>
        
        </div>
        <style>
            .ticket input{
                float: right;
                padding: 6px;
                border: none;
                margin-top: 8px;
                margin-right: 16px;
                font-size: 17px;
                border: 1px solid #ccc;
                margin:1% 0% 0% 0%;
            }
            .ticket button{
                float: right;
                padding: 7px 10px;
                margin-top: 8px;
                margin-right: 16px;
                font-size: 17px;
                border: none;
                cursor: pointer;
                background-color:	#DDDDDD;
                margin:1% 0% 0% 0%;
            }
            .ticket button:hover {
                background: #ccc;
            }
            </style>
        
<div id="content">
        <h1 style="margin: 0% 0% 0% 26%;">檢視/更新資料</h1>
        

       
    <form id="form1">
    
    <div class="regname">
        <label>姓名</label>
        <p  type="text" id="name" maxlength="50" required="required"></p>
    </div>>
    <div class="regemail">
        <label>信箱</label>
        <p  type="text" id="email" maxlength="100" required="required"></p><br>
    </div>
    <div class="regdob">
        <label>生日</label>
        <p type="text" id="dob" maxlength="10" required="required"></p><br>
    </div>
    <div class="regidnumber">
        <label>身分證</label>
        <p  type="text" id="idnumber" maxlength="10" required="required"></p><br>
    </div>
    <div class="regpassword">
        <label>密碼</label>
        <input type="password" id="password" maxlength="100" required="required"></input><br></br>
    </div>
    <div class="regphone">
        <label>手機</label>
        <input  type="text" id="phonenumber" maxlength="10" required="required" onkeyup="value=value.replace(/[^\d]/g,'') "></input><br></br>
    </div>
    <div class="regaddress">
        <label>地址</label>
        <input type="text" id="address" maxlength="100" required="required">
        <br>
    </div>
    
    
    &nbsp;<div class="submit">
        
    <input type ="button" id="submitForm"  value="確認"></input>
    <br>
    <br>
    <br>
   
    </form>

    <style>
        body{
            background-image: url("https://img.tixbar.com/concert/concert-list.jpg");
            background-repeat: no-repeat;
            background-size: cover;
            background-color:rgba(255,255,255,0.8);
            background-blend-mode: lighten;
        }
        .ticket body {
            filter:Alpha(opacity=0.5);
            width: 200%;
            background-size: 100% 100%;
        }
        .background {
            background-color: #FFEE99;
            border: 13px solid #FFEE99;
            padding: 13px;
            opacity:0.7;
        }
        /* .ticket {
            background-color: #444444;
            border: 13px solid #444444;
            padding: 13px;
            opacity:0.7;
        } */
        .regname label{
            font-size: 200%;
            color: black;
            margin: 0% 0% 0% 30%;
            font-weight: bold;
        }
        
        .regname input{
            width: 30%;
            padding: 5px 5px;
            border: 2px black solid;
            margin: 0% 35% 0% 0%;
           
        }
        .regphone label{
            font-size: 200%;
            color: black;
            margin: 0% 0% 0% 30%;
            font-weight: bold;
        }
        .regphone input{
            width: 30%;
            padding: 5px 5px;
            border: 2px black solid;
            margin: 0% 35% 0% 0%;
        }
        .regidnumber label{
            font-size: 200%;
            color: black;
            margin: 0% 0% 0% 28%;
            font-weight: bold;
        }
        
        .regidnumber input{
            width: 30%;
            padding: 5px 5px;
            border: 2px black solid;
            margin: 0% 35% 0% 0%;
           
        }
        .regemail label{
            font-size: 200%;
            color: black;
            margin: 0% 0% 0% 30%;
            font-weight: bold;
        }
        .regemail input{
            width: 30%;
            padding: 5px 5px;
            border: 2px black solid;
            margin: 0% 35% 0% 0%;
        }
        .regpassword label{
            font-size: 200%;
            color:black;
            margin: 0% 0% 0% 30%;
            font-weight: bold;
        }
        .regpassword input{
            width: 30%;
            padding: 5px 5px;
            border: 2px black solid;
            margin: 0% 35% 0% 0%;
        }
        .regaddress label {
            font-size: 200%;
            color: black;
            margin: 0 0 0 30%;
            font-weight: bold;
        }
        .regaddress input {
            width: 30%;
            padding: 5px;
            border: 2px black solid;
            margin: 0 35% 0 0;
        }

        .regdob label {
            font-size: 200%;
            color: black;
            margin: 0 0 0 30%;
            font-weight: bold;
        }

        .regdob input {
            width: 30%;
            padding: 5px;
            border: 2px black solid;
            margin: 0 35% 0 0;
        }
        .submit input{
            cursor:pointer;
            width:5%;
            margin: 0% 48% 0% 0%;
            background-color: #CCEEFF;
            border: 2px solid#CCDDFF;
        }
        </style>



<script type="text/javascript">
    $(document).ready(function () {
        $("#submitForm").click(function (e) {
            e.preventDefault();
            e.getMember();
             var email_rule = /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/;
             var phone_rule = /^[09]{2}[0-9]{8}$/;
             var password_rule = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/;


             if (!password_rule.test($("#password").val())) {
                 event.preventDefault();
                 alert("密碼格式不符!");
             }
             if (!phone_rule.test($("#phonenumber").val())) {
                 event.preventDefault();
                 alert("手機格式不符!");
             }
             if ($("#name").val()=="" || $("#password").val()=="" || $("#email").val()=="" || $("#dob").val()=="" || $("#phonenumber").val()=="" || $("#idnumber").val()=="" || $("#address").val()=="" ) {
                     event.preventDefault();
                     alert("尚未輸入完畢!");
                 }
             
            console.log("Submit")
            // console.log($("#name").val()())
            console.log(`${$("#name").val()}, ${$("#password").val()},${$("#email").val()}, ${$("#dob").val()},${$("#idnumber").val()},${$("#phonenumber").val()}, ${$("#address").val()}`)
            
            
            $.ajax({
                url: "/Auth/member",
                method: 'PUT',
                dataType: "JSON",
                data: {
                    password: $("#password").val(),
                    phonenumber: $("#phonenumber").val(),
                    address: $("#address").val()
                },
                error: function (err) {
                    console.log(err)
                },
                success: function (res) {
                    console.log(res.message)
                    window.location.replace(res.redirect);
                }
            });

        function getMember() {
            $.ajax({
                url: "/Auth/member",
                method:"GET",
                dataType:"JSON",
                success: function(response){
                    document.getElementById('name').value = response['response']['data'][0]['name'];
                    document.getElementById('email').value = response['response']['data'][0]['email'];
                    document.getElementById('dob').value = response['response']['data'][0]['dob'];
                    document.getElementById('idnumber').value = response['response']['data'][0]['idnumber'];
                    document.getElementById('password').value = response['response']['data'][0]['password'];
                    document.getElementById('phonenumber').value = response['response']['data'][0]['phonenumber'];
                    document.getElementById('address').value = response['response']['data'][0]['address'];
                    console.log(response);
                },
                error: function(err){
                    console.log(err) 
                }
            });
        }

        })
    })


</script>          

</body>
</html>







