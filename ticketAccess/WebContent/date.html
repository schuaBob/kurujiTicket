<!DOCTYPE html>
<html lang="zh-Hant-TW">

<meta charset="UTF-8">


<head>
    <link rel="stylesheet" type="text/css" href="style.css" />

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
        crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>





</head>





<body>
    <main>
        <header>
            <!--應該要匯入navbar ktml-->
            <div id="include"></div>

            <nav class="navbar navbar-light navbar-expand-lg fixed-top" id="navbar" style="padding-left:100vh">


                <nav class="navbar navbar-expand-lg navbar-light" style="background-color: white">
                    <a href="index.html" class=" navbar-brand" id="brand">

                        <img src='spotlights.png' id="logo">
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup"
                        aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                        <div class="navbar-nav">
                            <a class="nav-item nav-link  " id="space" href="index.html">現正熱映</a>
                            <span class="border border-dark navv"></span>
                            <a class="nav-item nav-link   active" id="space" href="date.html">我要購票</a>
                            <span class="border border-dark"></span>
                            <a class="nav-item nav-link  disable" id="space" href="order.html">訂單紀錄</a>
                            <span class="border border-dark"></span>
                            <a class="nav-item nav-link disable" id="space" href="#">會員</a>
                            <span class="border border-dark"></span>
                            <a class="nav-item nav-link " id="space" href="#">登出</a>

                        </div>
                    </div>
                </nav>
            </nav>
        </header>
        <!-- 引入測試-->
        <div w3-include-html="navbar.html"></div>
        <div>
            <div class="container">
                <div class="row">
                    <div class="col-6">
                        <p id="concert_name">周杰倫嘉年華演唱會</p>
                    </div>
                    <div class="col-4" id="concertdata" style="padding-top:6%;">

                    </div>
                </div>





                <!--進度-->
                <ul class="nav nav-pills" id="progress">
                    <li class="nav-item">
                        <a class="nav-link active" id="datetab" href="#dateset">選擇日期</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="tickettab">選擇票種</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="datatab">填寫表單</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="paytab">選擇付款方式</a>
                    </li>

                </ul>

                <div style="height:6vh;"></div>

                <!--第一頁-->
                <fieldset id="orderset">
                    <div class="row" style="padding-left:20%;">
                        <div class="w-25">
                            <div class="card">
                                <div class="card-body">
                                    <div id="concert1">
                                        <h5 class="card-title">2020/10/3星期六</h5>
                                        <p class="card-text">

                                            <p>周杰倫嘉年華演唱會</p>
                                            <p>台北小巨蛋</p>
                                            <p>19:00-21:00</p>
                                        </p>
                                    </div>
                                    <p id="quantitynow1" style="text-align:center">剩下3張</p>
                                    </p>
                                    <div style="text-align:center">
                                        <a href="tickettype.html" class="btn btn-primary" role="button" id="order_b1">立即訂購</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <span style="width:2%;"></span>
                        <div class="w-25">
                            <div class="card">
                                <div class="card-body">
                                    <div id="concert2">
                                        <h5 class="card-title">2020/10/4星期日</h5>
                                        <p class="card-text">
                                            <p>周杰倫嘉年華演唱會</p>
                                            <p>台北小巨蛋</p>
                                            <p>19:00-21:00</p>
                                        </p>
                                    </div>
                                    <p id="quantitynow2" style="text-align:center">剩下5張</p>
                                    </p>
                                    <div style="text-align:center">
                                        <a href="tickettype.html" class="btn btn-primary" role="button" id="order_b2">立即訂購</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <span style="width:2%;"></span>
                        <div class="w-25">
                            <div class="card">
                                <div class="card-body">
                                    <div id="concert3">
                                        <h5 class="card-title">2020/10/10星期六</h5>
                                        <p class="card-text">
                                            <p>周杰倫嘉年華演唱會</p>
                                            <p>台北小巨蛋</p>
                                            <p>19:00-21:00</p>
                                        </p>
                                    </div>
                                    <p id="quantitynow3" style="text-align:center">剩下0張</p>
                                    </p>
                                    <div style="text-align:center">
                                        <a href="tickettype.html" class="btn btn-primary" role="button" id="order_b3">立即訂購</a>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </fieldset>

            </div>
        </div>
        <script>
            //想替他們加名字

            $(document).ready(function () {

                //一開始跳轉此頁面
                //ajax load資料concertname,location,ticketstatus(價錢、幾區),座位數量?



                // getconcertdata();
                change_botton();
                storage();

                //寫入頁面
                //要有地方抓點入演唱會的id
                function getconcertdata() {
                    $.ajax({
                        url: "api/concert.do",
                        method: 'get',
                        dataType: 'json',
                        error: function (err) {
                            alert("無法連線到伺服器！");
                        },
                        success: function (data) {


                            //演唱會名字
                            $("#concert_name").html(data.name);

                            //逐一顯示
                            $.each(data.ticketstatus, function (i, item) {
                                $("#quantitynow" + i).html("剩下" + item.quantity + "張");

                                $("#concert" + i).html(item.content);
                            })


                        }

                    });
                }

                //改按鈕狀態
                function change_botton() {
                    if ($("#quantitynow1").html() == ("剩下" + 0 + "張")) {
                        $("#order_b1").addClass("disabled");
                        $("#order_b1").prop('disabled', true);
                        $("#order_b1").text("已售完");
                    };
                    if ($("#quantitynow2").html() == ("剩下" + 0 + "張")) {
                        $("#order_b2").addClass("disabled");
                        $("#order_b2").prop('disabled', true);
                        $("#order_b2").text("已售完");
                    };
                    if ($("#quantitynow3").html() == ("剩下" + 0 + "張")) {
                        $("#order_b3").addClass("disabled");
                        $("#order_b3").prop('disabled', true);
                        $("#order_b3").text("已售完");
                    };
                }

                function storage() {
                    $("#order_b1").click(function () {
                        localStorage.setItem("concert_content", $("#concert1").html());
                        localStorage.setItem("concert_id", 1);
                    });
                    $("#order_b2").click(function () {
                        localStorage.setItem("concert_content", $("#concert2").html());
                        localStorage.setItem("concert_id", 2);
                    });
                    $("#order_b1").click(function () {
                        localStorage.setItem("concert_content", $("#concert3").html());
                        localStorage.setItem("concert_id", 3);
                    });
                }



            });

        </script>
    </main>
</body>


</html>